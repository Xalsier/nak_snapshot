const 日=(e,t)=>new Date(e,t,1).getDay(),古=(e,t,n)=>new Date(e,t,n).getTime()<Date.now(),今=(e,t,n)=>new Date(e,t,n).setHours(0,0,0,0)===new Date().setHours(0,0,0,0),隠=()=>面&&(面.innerHTML=""),獲=()=>fetch("eve.json").then(e=>e.json()).then(e=>e.events),設=(e,t)=>{(文=書[找]("calendar-month-year"))&&(文.innerHTML=12*e+t+1)},載=async e=>{let t=new Image;return t.src=e,await t.decode(),面.innerHTML="",面.appendChild(t),!0},探=(e,t,n,a)=>e.find(e=>new Date(e.date).setHours(0,0,0,0)==new Date(t,n,a).getTime())??null,映=e=>{for(let t of(面||((面=書[元]("div"))[名]="event-image-container",書.body.appendChild(面)),e))if(載(t.src))break},造=(e,t,n,a)=>{let d=書[元]("div"),i=日(n,a);d[名]="calendar-container",["日","月","火","水","木","金","土"].forEach(e=>d.appendChild(Object.assign(書[元]("div"),{[名]:"calendar-weekday",textContent:e})));for(let r=0;r<i;r++)d.appendChild(Object.assign(書[元]("div"),{[名]:"calendar-day empty"}));for(let s=1;s<=t;s++){let l=書[元]("div"),o=e[`${n}-${(a+1).toString().padStart(2,"0")}-${s.toString().padStart(2,"0")}`];l[名]="calendar-day",l.setAttribute("data-day",s),l.innerHTML=s,今(n,a,s)&&l.classList.add("today","vibrate"),古(n,a,s)?l.classList.add("past",`past-event-${o?.type}`):l.classList.add(`event-${o?.type}`),o?.images&&(l.addEventListener("mouseenter",()=>映(o.images,l.getBoundingClientRect())),l.addEventListener("mouseleave",隠)),d.appendChild(l)}return d};面=null,初=new Date,元="createElement",名="className",找="getElementById",旧=(書=document)[找]("previous-month"),新=書[找]("next-month"),(更=e=>{初.setMonth(初.getMonth()+e),年=初.getFullYear(),月=初.getMonth(),数=new Date(年,月+1,0).getDate(),設(年,月),獲().then(e=>{体=造(e,数,年,月),(根=書[找]("calendar"))&&(根.innerHTML="",根.appendChild(体))})})(0),旧.onclick=()=>更(-1),新.onclick=()=>更(1);